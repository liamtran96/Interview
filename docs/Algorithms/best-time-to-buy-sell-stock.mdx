---
sidebar_position: 3
---

import AlgorithmProblem from '@site/src/components/AlgorithmProblem';

# Best Time to Buy and Sell Stock

<AlgorithmProblem
  title="Best Time to Buy and Sell Stock"
  difficulty="Easy"
  description={`
<p>You are given an array <code>prices</code> where <code>prices[i]</code> is the price of a given stock on the <code>i<sup>th</sup></code> day.</p>
<p>You want to maximize your profit by choosing a <strong>single day</strong> to buy one stock and choosing a <strong>different day in the future</strong> to sell that stock.</p>
<p>Return <em>the maximum profit you can achieve from this transaction</em>. If you cannot achieve any profit, return <code>0</code>.</p>
<h4>Constraints:</h4>
<ul>
  <li>1 ≤ prices.length ≤ 10<sup>5</sup></li>
  <li>0 ≤ prices[i] ≤ 10<sup>4</sup></li>
</ul>
`}
  examples={[
    {
      input: 'prices = [7,1,5,3,6,4]',
      output: '5',
      explanation: 'Buy on day 2 (price = 1) and sell on day 5 (price = 6), profit = 6-1 = 5.'
    },
    {
      input: 'prices = [7,6,4,3,1]',
      output: '0',
      explanation: 'No profit can be made, so return 0.'
    }
  ]}
  starterCode={`function maxProfit(prices) {
  // Write your code here

}`}
  solution={`function maxProfit(prices) {
  // Track minimum price and maximum profit: O(n) time, O(1) space
  let minPrice = Infinity;
  let maxProfit = 0;

  for (let i = 0; i < prices.length; i++) {
    // Update minimum price seen so far
    if (prices[i] < minPrice) {
      minPrice = prices[i];
    }
    // Calculate profit if we sell today
    else {
      const profit = prices[i] - minPrice;
      maxProfit = Math.max(maxProfit, profit);
    }
  }

  return maxProfit;
}`}
  testCases={[
    {
      input: [[7, 1, 5, 3, 6, 4]],
      expected: 5,
      description: 'Buy at 1, sell at 6: profit = 5'
    },
    {
      input: [[7, 6, 4, 3, 1]],
      expected: 0,
      description: 'Prices only decrease: no profit'
    },
    {
      input: [[1, 2]],
      expected: 1,
      description: 'Simple case: buy at 1, sell at 2'
    },
    {
      input: [[2, 4, 1]],
      expected: 2,
      description: 'Buy at 2, sell at 4 (not at 1 since it comes after)'
    },
    {
      input: [[3, 2, 6, 5, 0, 3]],
      expected: 4,
      description: 'Buy at 2, sell at 6: profit = 4'
    }
  ]}
  functionName="maxProfit"
/>

## Solution Explanation

### Approach 1: Brute Force (Not Recommended)

**Time Complexity:** O(n²)
**Space Complexity:** O(1)

Try every possible buy/sell combination:

```javascript
function maxProfit(prices) {
  let maxProfit = 0;

  for (let i = 0; i < prices.length; i++) {
    for (let j = i + 1; j < prices.length; j++) {
      const profit = prices[j] - prices[i];
      maxProfit = Math.max(maxProfit, profit);
    }
  }

  return maxProfit;
}
```

**Why avoid this?**
- Too slow for large arrays
- Doesn't demonstrate optimization skills

### Approach 2: One Pass (Optimal) ✅

**Time Complexity:** O(n)
**Space Complexity:** O(1)

Track minimum price and maximum profit in single pass:

```javascript
function maxProfit(prices) {
  let minPrice = Infinity;
  let maxProfit = 0;

  for (let i = 0; i < prices.length; i++) {
    if (prices[i] < minPrice) {
      minPrice = prices[i];
    } else {
      const profit = prices[i] - minPrice;
      maxProfit = Math.max(maxProfit, profit);
    }
  }

  return maxProfit;
}
```

**Key insight:** We need to find:
- The **minimum price** to buy at
- The **maximum profit** after that minimum

**How it works:**

```
prices = [7, 1, 5, 3, 6, 4]

Day 0: price=7
  - minPrice = 7
  - maxProfit = 0

Day 1: price=1
  - minPrice = 1 (new minimum!)
  - maxProfit = 0

Day 2: price=5
  - minPrice = 1
  - profit = 5 - 1 = 4
  - maxProfit = 4

Day 3: price=3
  - minPrice = 1
  - profit = 3 - 1 = 2
  - maxProfit = 4 (no change)

Day 4: price=6
  - minPrice = 1
  - profit = 6 - 1 = 5 ← NEW MAX!
  - maxProfit = 5

Day 5: price=4
  - minPrice = 1
  - profit = 4 - 1 = 3
  - maxProfit = 5 (final answer)
```

### Cleaner Version

```javascript
function maxProfit(prices) {
  let minPrice = Infinity;
  let maxProfit = 0;

  for (const price of prices) {
    minPrice = Math.min(minPrice, price);
    maxProfit = Math.max(maxProfit, price - minPrice);
  }

  return maxProfit;
}
```

### Pattern: Greedy Algorithm

This uses a **greedy approach**:
- Make the locally optimal choice at each step
- Track the best seen so far
- One pass through data

**Similar problems:**
- Maximum Subarray (Kadane's Algorithm)
- Buy/Sell Stock II (Multiple Transactions)

## Key Insights

1. **We can only buy once and sell once**
2. **Must buy before selling** (can't go back in time)
3. **Track minimum as we go** instead of looking ahead
4. **Update max profit continuously**

### Visual Example

```
Prices:  7  →  1  →  5  →  3  →  6  →  4

Min:     7     1     1     1     1     1
Profit:  0     0     4     2     5     3
                            ↑
                      Best profit!
```

## Common Mistakes

❌ **Buying and selling on the same day:**
```javascript
maxProfit = Math.max(maxProfit, 0); // Always return at least 0
```

❌ **Selling before buying:**
```javascript
// Must ensure buy day < sell day
// Our approach naturally handles this
```

❌ **Not handling decreasing prices:**
```javascript
prices = [7, 6, 4, 3, 1] // Should return 0
```

❌ **Using nested loops:**
```javascript
// O(n²) is too slow for large inputs
```

## Interview Tips

**What to say:**
1. "I'll track the minimum price seen so far"
2. "For each price, calculate profit if I sell today"
3. "Keep track of maximum profit"
4. "This is O(n) time and O(1) space"

**Follow-up questions:**
- **What if we can make multiple transactions?**
  - Different problem: Buy/Sell Stock II
  - Add up all positive differences

- **What if there's a transaction fee?**
  - Subtract fee from each profit calculation

- **What if we can only make k transactions?**
  - Need dynamic programming approach

## Related Problems

- **Best Time to Buy and Sell Stock II** (Medium) - Multiple transactions
- **Best Time to Buy and Sell Stock III** (Hard) - At most 2 transactions
- **Best Time to Buy and Sell Stock with Cooldown** (Medium)
- **Best Time to Buy and Sell Stock with Transaction Fee** (Medium)

## Edge Cases to Consider

```javascript
// Single day - no transaction possible
prices = [5] → return 0

// Two days - simple comparison
prices = [1, 2] → return 1

// All decreasing - no profit
prices = [5, 4, 3, 2, 1] → return 0

// All same price - no profit
prices = [3, 3, 3, 3] → return 0
```
